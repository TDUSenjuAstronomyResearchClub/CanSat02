graph TD
    A[開始] -->|自立制御で運転| B[割り込み要因の発生を待機]
    B -->|割り込み要因の発生を検知| C[割り込みフラグをセット]
    C -->|メインプログラムの処理を継続| D[割り込みフラグがセットされているか確認]
    D -->|割り込みフラグがセットされている場合| E[手動運転モードに切り替え]
    D -->|割り込みフラグがセットされていない場合| C
    E -->|割り込みフラグをクリア| F[手動運転で運転]
    F -->|endコマンドの受信を待機| G[メインプログラムの処理を再開]
    G -->|endコマンドを受信| H[自立制御で運転に切り替え]
    H -->|メインプログラムの処理を再開| C
